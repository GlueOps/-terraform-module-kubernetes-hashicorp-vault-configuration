# terraform-module-kubernetes-hashicorp-vault-configuration

This Terraform module configures vault for kvv2 usage. This repo should be used in the context of deploying with an [admiral](https://github.com/glueops/admiral) and after you have [initialized](https://github.com/GlueOps/terraform-module-kubernetes-hashicorp-vault-initialization) the vault cluster

## Prerequisites

Assume you have just deployed <https://github.com/GlueOps/terraform-module-kubernetes-hashicorp-vault-initialization> and still have the SSL cert in a environment variable and connection to vault running via `kubectl port-forward`

### Example of the configurations expected by this module

```hcl
vault_configurations = {
  oidc_client_secret = "yolo1234"
  captain_domain     = "test-30-np.venkata.onglueops.rocks"
  org_team_policy_mappings = [
    {
      oidc_groups = ["GlueOps:vault_super_admins"]
      policy_name = "editor"
    },
    {
      oidc_groups = ["GlueOps:vault_super_admins", "glueops-rocks:developers"]
      policy_name = "reader"
    }
  ]
}
```

### policy_names

| policy_name | description                          |
|-------------|--------------------------------------|
| reader      | read all secrets                     |
| editor      | read/write/delete/update all secrets |

